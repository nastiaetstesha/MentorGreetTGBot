import jj
import sh
import json

from jj.mock import mocked


def test_mock_mentors():
    matcher = jj.match("GET", "/mentors")
    response = jj.Response(
        status=200,
        json={
            "mentors": [
                {"id": 1, "name": {"first": "–ï–≤–≥–µ–Ω–∏–π", "second": "Devman"}, "tg_username": "@eugene_dev", "tg_chat_id": 41878799, "bday": "1991-02-23"},
                {"id": 2, "name": {"first": "–ò–ª—å–º–∏—Ä", "second": "Devman"}, "tg_username": "@ilmir_dev", "tg_chat_id": 6467718221},
                {"id": 3, "name": {"first": "–ù—É—Ä–±–µ–∫", "second": "Devman"}, "tg_username": "@nurbek_dev", "tg_chat_id": 335075762, "bday": "1991-02-23"},
                {"id": 4, "name": {"first": "–ö–∞—Ç—è", "second": "–ò–≤–∞–Ω–æ–≤–∞"}, "tg_username": "@katie", "tg_chat_id": 335000000},
                {"id": 5, "name": {"first": "–ò–≤–∞–Ω", "second": "–ü–µ—Ç—Ä—è–∫–æ–≤"}, "tg_username": "@i_petr", "tg_chat_id": 335000001, "bday": "1991-02-23"},
                {"id": 6, "name": {"first": "–ê–º–∏—Ä", "second": "–ê–º–∏—Ä–æ–≤"}, "tg_username": "@aarr", "tg_chat_id": 335000002, "bday": "1995-09-01"}
            ]
        }
    )
    
    with mocked(matcher, response):
        res = sh.curl("-s", "http://localhost:8080/mentors")
        data = json.loads(res)
        print(json.dumps(data, ensure_ascii=False, indent=2))


def test_mock_postcards():
    matcher = jj.match("GET", "/postcards")
    response = jj.Response(
        status=200,
        json={
           "postcards": [
    {
      "id": 1,
      "holidayId": "01.01",
      "name_ru": "–ù–æ–≤—ã–π –≥–æ–¥",
      "body": "üéâ‚ú®–° –ù–æ–≤—ã–º –≥–æ–¥–æ–º! –ü—É—Å—Ç—å —ç—Ç–æ—Ç –≥–æ–¥ –ø—Ä–∏–Ω–µ—Å—ë—Ç –≤–∞–º –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ —Å—á–∞—Å—Ç—å–µ, –∑–¥–æ—Ä–æ–≤—å–µ –∏ —É—Å–ø–µ—Ö –≤ –∫–∞–∂–¥–æ–º –Ω–∞—á–∏–Ω–∞–Ω–∏–∏. –ü—É—Å—Ç—å –º–µ—á—Ç—ã —Å–±—ã–≤–∞—é—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –≤—ã —É—Å–ø–µ–µ—Ç–µ –∏—Ö –∑–∞–≥–∞–¥–∞—Ç—å, –∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –¥–∞—Ä–∏—Ç –Ω–æ–≤—ã–µ –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–µ –º–æ–º–µ–Ω—Ç—ã. –ü—É—Å—Ç—å –≤–∞—à –¥–æ–º –Ω–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ª—é–±–æ–≤—å—é, –∞ —Å–µ—Ä–¥—Ü–µ ‚Äî –æ–ø—Ç–∏–º–∏–∑–º–æ–º. –ü—É—Å—Ç—å —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏ –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –∞ —É–¥–∞—á–∞ –≤—Å–µ–≥–¥–∞ –∏–¥–µ—Ç —Ä—É–∫–∞ –æ–± —Ä—É–∫—É —Å –≤–∞–º–∏. –° –ù–æ–≤—ã–º –≥–æ–¥–æ–º! üåüÊÑøÊñ∞Âπ¥ÂÖÖÊª°ÊÉäÂñúÂíåÊàêÂ∞±ÔºÅ–ü—É—Å—Ç—å –≤–∞—à –ø—É—Ç—å –≤ –Ω–æ–≤–æ–º –≥–æ–¥—É –±—É–¥–µ—Ç —É—Å—ã–ø–∞–Ω –∑–≤—ë–∑–¥–∞–º–∏ –Ω–∞–¥–µ–∂–¥—ã –∏ —Ü–≤–µ—Ç–∞–º–∏ —Ä–∞–¥–æ—Å—Ç–∏. –° –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º! üéÜ –ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π –≤–∞—à —à–∞–≥ –≤–µ–¥—ë—Ç –∫ –º–µ—á—Ç–µ, –∞ –≤–æ–∫—Ä—É–≥ –≤–∞—Å –≤—Å–µ–≥–¥–∞ –±—É–¥—É—Ç —Ç–µ, –∫—Ç–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏ –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç. –ü—É—Å—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π —É—Å–ø–µ—Ö —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç –≤–∞—Å, –∞ –∑–¥–æ—Ä–æ–≤—å–µ –∫—Ä–µ–ø–Ω–µ—Ç —Å –∫–∞–∂–¥—ã–º –¥–Ω—ë–º. –° –ù–æ–≤—ã–º –≥–æ–¥–æ–º! üåü"
    },
    {
      "id": 2,
      "holidayId": "01.01",
      "name_ru": "–ù–æ–≤—ã–π –≥–æ–¥",
      "body": "üöÄ–ù–æ–≤—ã–π –≥–æ–¥ ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –¥–∞—Ç–∞, –∞ –Ω–∞—á–∞–ª–æ –Ω–æ–≤–æ–π –≥–ª–∞–≤—ã –≤ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏! –ü—É—Å—Ç—å –æ–Ω–∞ –±—É–¥–µ—Ç –Ω–∞–ø–∏—Å–∞–Ω–∞ —Å—á–∞—Å—Ç—å–µ–º, –Ω–∞–ø–æ–ª–Ω–µ–Ω–∞ —Å–º–µ–ª—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏ –∏ –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—ã–º–∏ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è–º–∏. –ü—É—Å—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ –∫—Ä–µ–ø–Ω–µ—Ç —Å –∫–∞–∂–¥—ã–º –¥–Ω—ë–º, –∞ –∫–∞—Ä—å–µ—Ä–∞ –≤–∑–ª–µ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–∫–µ—Ç–∞. –ü—É—Å—Ç—å —Ñ–∏–Ω–∞–Ω—Å—ã —Ä–∞—Å—Ç—É—Ç, –∫–∞–∫ –Ω–æ–≤–æ–≥–æ–¥–Ω—è—è —ë–ª–∫–∞, –∞ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Ç–µ–ø–ª–µ–µ. –ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π –≤–∞—à —à–∞–≥ –≤–µ–¥—ë—Ç –∫ –º–µ—á—Ç–µ, –∞ —Å–µ—Ä–¥—Ü–µ –≤—Å–µ–≥–¥–∞ –ø–æ–ª–Ω—ã–º –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è! –° –Ω–∞—Å—Ç—É–ø–∞—é—â–∏–º –ù–æ–≤—ã–º –≥–æ–¥–æ–º! üåà‚ú®Á•ùÊÇ®Êñ∞Âπ¥Âø´‰πêÔºÅÊÑøÂπ∏Á¶è‰∏éÊÇ®Â∏∏‰º¥ÔºåÊàêÂäü‰∏éÊÇ®ÂêåË°å„ÄÇ–° –Ω–æ–≤—ã–º –≥–æ–¥–æ–º! üéÑ –ü—É—Å—Ç—å –≤–∞—à–∞ —Å–µ–º—å—è –∏ –¥—Ä—É–∑—å—è –¥–∞—Ä—è—Ç —Ç–µ–ø–ª–æ, –∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç –æ —Ç–æ–º, –∫–∞–∫ –ø—Ä–µ–∫—Ä–∞—Å–Ω–∞ –∂–∏–∑–Ω—å. –° –ù–æ–≤—ã–º –≥–æ–¥–æ–º! üåü"
    },
    {
      "id": 3,
      "holidayId": "01.01",
      "name_ru": "–ù–æ–≤—ã–π –≥–æ–¥",
      "body": "–° –ù–æ–≤—ã–º –≥–æ–¥–æ–º! –ü—É—Å—Ç—å –≤—Å—ë –∑–∞–¥—É–º–∞–Ω–Ω–æ–µ —Å–±—É–¥–µ—Ç—Å—è! üéâ"
    },
    {
      "id": 4,
      "holidayId": "01.01",
      "name_ru": "–ù–æ–≤—ã–π –≥–æ–¥",
      "body": "–ü—É—Å—Ç—å –ù–æ–≤—ã–π –≥–æ–¥ –ø—Ä–∏–Ω–µ—Å–µ—Ç —É–¥–∞—á—É –∏ —Ä–∞–¥–æ—Å—Ç—å! üéá"
    },
    {
      "id": 5,
      "holidayId": "01.01",
      "name_ru": "–ù–æ–≤—ã–π –≥–æ–¥",
      "body": "–ù–æ–≤–æ–≥–æ–¥–Ω–∏–µ —á—É–¥–µ—Å–∞ —É–∂–µ –Ω–∞—á–∞–ª–∏—Å—å! üåü"
    },
    {
      "id": 6,
      "holidayId": "birthday",
      "name_ru": "–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è",
      "body": "üéÇüéâ #name, –° –î–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è! –ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å —ç—Ç–æ–≥–æ –≥–æ–¥–∞ –±—É–¥–µ—Ç –Ω–∞–ø–æ–ª–Ω–µ–Ω —Ä–∞–¥–æ—Å—Ç—å—é, –ª—é–±–æ–≤—å—é –∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ–º! –ñ–µ–ª–∞—é, —á—Ç–æ–±—ã –≤–∞—à–∏ –º–µ—á—Ç—ã –ø—Ä–µ–≤—Ä–∞—â–∞–ª–∏—Å—å –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å, –∞ –∫–∞–∂–¥—ã–π —à–∞–≥ –ø—Ä–∏–±–ª–∏–∂–∞–ª –∫ —É—Å–ø–µ—Ö—É. –ü—É—Å—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ –∫—Ä–µ–ø—á–∞–µ—Ç, –∞ —É–ª—ã–±–∫–∞ –Ω–µ —Å—Ö–æ–¥–∏—Ç —Å –ª–∏—Ü–∞. –í–æ–∫—Ä—É–≥ –≤–∞—Å –ø—É—Å—Ç—å –≤—Å–µ–≥–¥–∞ –±—É–¥—É—Ç –≤–µ—Ä–Ω—ã–µ –¥—Ä—É–∑—å—è –∏ –±–ª–∏–∑–∫–∏–µ, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –≤ —Ç—Ä—É–¥–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã. –° –î–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è! –ü—É—Å—Ç—å –≤–∞—à –≤–æ–∑—Ä–∞—Å—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–µ–µ, –∞ —Å–µ—Ä–¥—Ü–µ ‚Äî –º–æ–ª–æ–∂–µ! üå∏‚ú®ÊÑøÁîüÊó•ÂÖÖÊª°Ê¨¢Á¨ëÂíåÊÉäÂñúÔºÅ–° –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º! üéÅ –ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π –≤–∞—à –¥–µ–Ω—å –¥–∞—Ä–∏—Ç –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –∞ –∂–∏–∑–Ω—å –Ω–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤–æ–ª—à–µ–±—Å—Ç–≤–æ–º. –° –î–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è! üåü"
    },
    {
      "id": 7,
      "holidayId": "birthday",
      "name_ru": "–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è",
      "body": "üéÅüéà #name, –° –î–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è! –ü—É—Å—Ç—å –∂–∏–∑–Ω—å –¥–∞—Ä–∏—Ç –≤–∞–º —Ç–æ–ª—å–∫–æ –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã, –∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ª—É—á—à–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ. –ñ–µ–ª–∞—é, —á—Ç–æ–±—ã –≤–∞—à –¥–æ–º –±—ã–ª –ø–æ–ª–æ–Ω —Ç–µ–ø–ª–∞, –∞ —Å–µ—Ä–¥—Ü–µ ‚Äî –ª—é–±–≤–∏. –ü—É—Å—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–¥–≤–æ–¥–∏—Ç, –∞ —É–¥–∞—á–∞ —Å–ª–µ–¥—É–µ—Ç –∑–∞ –≤–∞–º–∏ –ø–æ–≤—Å—é–¥—É. –í —ç—Ç–æ—Ç –æ—Å–æ–±–µ–Ω–Ω—ã–π –¥–µ–Ω—å –∂–µ–ª–∞—é, —á—Ç–æ–±—ã –≤—Å–µ –≤–∞—à–∏ –∂–µ–ª–∞–Ω–∏—è –∏—Å–ø–æ–ª–Ω–∏–ª–∏—Å—å, –∞ –º–µ—á—Ç—ã —Å—Ç–∞–ª–∏ –±–ª–∏–∂–µ. –° –î–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è! üåüüåü–°—á–∞—Å—Ç–ª–∏–≤–æ–≥–æ –¥–Ω—è —Ä–æ–∂–¥–µ–Ω–∏—è! üéÇ –ü—É—Å—Ç—å –≤–∞—à–∞ —Å–µ–º—å—è –∏ –¥—Ä—É–∑—å—è –æ–∫—Ä—É–∂–∞—é—Ç –≤–∞—Å –∑–∞–±–æ—Ç–æ–π, –∞ –∫–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –≥–æ–¥ –ø—Ä–∏–Ω–æ—Å–∏—Ç —Ç–æ–ª—å–∫–æ —Ä–∞–¥–æ—Å—Ç—å –∏ —É—Å–ø–µ—Ö. üåà‚ú®"
    },
    {
      "id": 8,
      "holidayId": "birthday",
      "name_ru": "–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è",
      "body": "–° –î–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è! –ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –¥–∞—Ä–∏—Ç —Ä–∞–¥–æ—Å—Ç—å! üéÇ"
    },
    {
      "id": 9,
      "holidayId": "birthday",
      "name_ru": "–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è",
      "body": "–ü–æ–∑–¥—Ä–∞–≤–ª—è—é —Å –î–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è! –ü—É—Å—Ç—å –º–µ—á—Ç—ã —Å–±—ã–≤–∞—é—Ç—Å—è! üåà"
    },
    {
      "id": 10,
      "holidayId": "birthday",
      "name_ru": "–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è",
      "body": "–° –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è! –í—Å–µ–≥–æ —Å–∞–º–æ–≥–æ –Ω–∞–∏–ª—É—á—à–µ–≥–æ! üéÅ"
    }
  ]
        }
    )

    with mocked(matcher, response):
        res = sh.curl("-s", "http://localhost:8080/postcards")
        data = json.loads(res)
        print(json.dumps(data, ensure_ascii=False, indent=2))

if __name__ == "__main__":
    test_mock_mentors()
    test_mock_postcards()

    # jj --port 8080
